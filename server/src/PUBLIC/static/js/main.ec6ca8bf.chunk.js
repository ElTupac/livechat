(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{14:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n(1),r=n(8),s=n.n(r),i=n(2),o=n(3),d=n(6),u=n(5),j=n(4),h=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){var e,t=this.props.chatOf,n=this.props.info;return e=t==n.from?"#fff":"#07bc4c",Object(c.jsx)("div",{children:Object(c.jsx)("p",{style:{background:e},children:n.mess})})}}]),n}(a.Component),b=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props.info.chat,t=this.props.info.chatOf,n=e.map((function(e,n){return Object(c.jsx)(h,{info:e,chatOf:t},"".concat(t,"-").concat(n))}));return Object(c.jsxs)("div",{children:[Object(c.jsx)("h2",{children:t}),n]})}}]),n}(a.Component),l=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(e){var c;return Object(i.a)(this,n),(c=t.call(this,e)).state={socket:void 0,chats:[]},c}return Object(o.a)(n,[{key:"enviarMensaje",value:function(e,t){var n=this.props.creds,c=n.name,a=n.id,r={from:"".concat(c,"#").concat(a),to:e,mess:t};this.state.socket.send(JSON.stringify(r)),this.addMessage(JSON.stringify(r),!0)}},{key:"componentDidMount",value:function(){var e=this,t=this.props.creds,n=t.name,c=t.id;if(n&&c){var a=new WebSocket("ws://186.13.4.194:4000/?id=".concat(c,"&name=").concat(n));a.onopen=function(t){console.log("Conectado"),e.setState({socket:a}),document.getElementById("enviar-btn").addEventListener("click",(function(t){var n=document.getElementById("para").value,c=document.getElementById("texto").value;n&&c&&e.enviarMensaje(n,c)}))},a.onmessage=function(t){e.addMessage(t.data,!1)}}}},{key:"addMessage",value:function(e,t){var n,c=JSON.parse(e),a=c.from,r=c.to,s=c.mess,i=this.state.chats;for(var o in i)if(i[o].chatOf==a||i[o].chatOf==r){n=o;break}n?i[n].chat.push({from:a,to:r,mess:s}):i.push({chatOf:t?r:a,chat:[{from:a,to:r,mess:s}]}),this.setState({chats:i})}},{key:"render",value:function(){var e=this.state.chats.map((function(e){return Object(c.jsx)(b,{info:e},e.chatOf)}));return Object(c.jsxs)("div",{children:[Object(c.jsx)("input",{type:"text",id:"para",placeholder:"Destinatario"}),Object(c.jsx)("br",{}),Object(c.jsx)("textarea",{id:"texto",cols:"30",rows:"5",placeholder:"Mensaje"}),Object(c.jsx)("br",{}),Object(c.jsx)("button",{id:"enviar-btn",children:"Enviar"}),Object(c.jsx)("br",{}),e]})}}]),n}(a.Component),f=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;document.getElementById("crear-btn").addEventListener("click",(function(t){var n=document.getElementById("name").value;n&&fetch("http://186.13.4.194:4000/newid/".concat(n)).then((function(e){return e.json()})).then((function(t){t.error?console.log(t.error):e.props.creds(t.creds.name,t.creds._id)}))}))}},{key:"render",value:function(){return Object(c.jsxs)("div",{children:[Object(c.jsx)("input",{type:"text",id:"name"}),Object(c.jsx)("button",{id:"crear-btn",children:"Crear"})]})}}]),n}(a.Component),O=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(e){var c;return Object(i.a)(this,n),(c=t.call(this,e)).state={name:void 0,id:void 0},c.setCredentials=c.setCredentials.bind(Object(d.a)(c)),c}return Object(o.a)(n,[{key:"setCredentials",value:function(e,t){this.setState({name:e,id:t})}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.id;if(t||n){var a={name:t,id:n};return Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"".concat(t,"#").concat(n)}),Object(c.jsx)(l,{creds:a})]})}return Object(c.jsx)(f,{creds:this.setCredentials})}}]),n}(a.Component);s.a.render(Object(c.jsx)(O,{}),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.ec6ca8bf.chunk.js.map